# 📋 주식 P/E, PEG 비율 크롤링 시스템 제작지침 명세서

## 🎯 목적
주요 주식 종목들의 P/E 비율과 PEG 비율을 자동으로 수집하여 CSV 파일로 저장하는 크롤링 시스템 구축

10개정도의 데이터를 크롤링하여 테스해보고, 확인되면, 나스닥100종목으로 확장한다. 

## 📦 필요 라이브러리 및 환경 설정

### 1. 기본 라이브러리 import
- **yfinance**: 야후 파이낸스 API를 통한 주식 데이터 수집
- **pandas**: 데이터 처리 및 CSV 저장
- **json**: 상세 정보 JSON 파일 저장
- **datetime**: 현재 날짜 정보 처리
- **time**: API 요청 간 대기 시간 설정

### 2. SSL 인증서 문제 해결
- urllib3 경고 메시지 비활성화
- SSL 검증 비활성화 설정 (보안 주의사항 있음)

## 🏗️ 시스템 구조 설계

### 1. 기본 설정
- 현재 날짜를 `YYYY-MM-DD` 형식으로 가져오기
- 분석할 주식 티커 목록 정의 (`AAPL`, `MSFT`, `GOOGL`, `TSLA`, `NVDA`)
- 결과 저장용 빈 리스트 생성

### 2. 데이터 수집 필드 정의
수집할 데이터 필드:
- **날짜**
- **종목명** (회사 정식 명칭)
- **티커 심볼**
- **산업군** (섹터 + 세부 산업)
- **현재 가격**
- **Trailing P/E 비율**
- **Forward P/E 비율**
- **PEG 비율**

## 🔄 크롤링 프로세스

### 1. 각 티커별 반복 처리
각 주식 티커에 대해 다음 단계 수행:

#### a) 데이터 수집 준비
- 진행 상황 콘솔 출력
- yfinance Ticker 객체 생성
- API 제한 회피를 위한 1초 대기

#### b) 주식 정보 가져오기
- `info` 속성을 통한 상세 정보 수집
- 오류 발생 시 예외 처리

#### c) JSON 백업 파일 생성
- 전체 데이터를 JSON 형태로 개별 파일에 저장
- 파일명: `{티커}_info_{날짜}.json`

#### d) 필요한 데이터 추출
- `longName` 또는 `shortName`에서 회사명 추출
- `sector`와 `industry` 정보에서 산업군 구성
- `currentPrice`, `trailingPE`, `forwardPE`, `trailingPegRatio` 추출

#### e) 데이터 가공
- 산업군 정보를 **"섹터 - 세부산업"** 형태로 조합
- 누락된 정보는 `'N/A'`로 처리

#### f) 콘솔 출력
- 수집된 정보를 보기 좋게 정리하여 출력

#### g) 결과 리스트에 추가
- 유효한 데이터가 있는 경우에만 리스트에 저장

### 2. 오류 처리
- 각 티커별로 독립적인 예외 처리
- 하나의 티커에서 오류가 발생해도 다른 티커 처리 계속

## 💾 데이터 저장 및 출력

### 1. DataFrame 생성
- 수집된 리스트를 pandas DataFrame으로 변환
- 빈 데이터인 경우 빈 DataFrame 생성

### 2. 결과 출력
- 수집된 전체 데이터를 테이블 형태로 출력
- 각 종목별 요약 정보를 보기 좋게 정리하여 출력

### 3. CSV 파일 저장
- 파일명: `stock_pe_peg_{날짜}.csv`
- UTF-8 BOM 인코딩으로 한글 호환성 확보
- 인덱스 제외하고 저장

## ⚠️ 주의사항 및 최적화

### 1. Windows 환경에서의 Python 실행
- `python` 명령어 대신 **`py` 명령어 사용 권장**
- PATH 설정 문제로 인한 실행 오류 방지

### 2. 코드 품질 개선사항
- pandas DataFrame의 `_append` 메서드 대신 **리스트 활용**
- 린터 에러 방지를 위한 타입 안전성 확보
- FutureWarning 제거

### 3. API 안정성
- 요청 간 **1초 대기**로 API 제한 회피
- SSL 인증서 문제 우회 설정

### 4. 데이터 백업
- 각 종목별 상세 정보를 JSON 파일로 개별 저장
- 추후 분석이나 디버깅 시 활용 가능

## 🎯 최종 결과물
1. **메인 CSV 파일**: 모든 종목의 P/E, PEG 데이터가 정리된 파일
2. **개별 JSON 파일**: 각 종목의 상세 정보 백업 파일
3. **콘솔 출력**: 실시간 진행 상황 및 요약 정보

## 📊 예시 출력 결과

| 종목명 | 티커 | 산업군 | 현재가격 | Trailing P/E | Forward P/E | PEG Ratio |
|--------|------|---------|----------|--------------|-------------|-----------|
| Apple Inc. | AAPL | Technology - Consumer Electronics | $211.18 | 32.89 | 25.41 | 1.97 |
| Microsoft Corporation | MSFT | Technology - Software - Infrastructure | $510.05 | 39.36 | 34.12 | 2.39 |
| Alphabet Inc. | GOOGL | Communication Services - Internet Content & Information | $185.06 | 20.65 | 20.65 | 1.38 |

## 🚀 실행 방법
```bash
py crawl_pe_peg.py
```

---

**이 명세서를 따라 구현하면 안정적이고 확장 가능한 주식 데이터 크롤링 시스템을 구축할 수 있습니다.** 

프론트엔드 구현방향>

이렇게 저장된 csv 파일에서, 다음의 조건에 따라  웹페이지를 출력하자. 
제목, 나스닥 100 주요 종목 분석 (peg)
보여줄 필드는 다음과 같다. 
종목명, 티커, 산업군,  현재가격, Trail P/E, For P/E, PEG 
peg 값은 1미만이면 파란색, 1~2 이면 노란색, 2 이상이면 빨간색으로 표시하라. 
각 필드는 모두 정열버튼 기능을 구현해다오. 

🎯 PEG 비율 해석 가이드 아래에, 다음의 메시지를 넣어라. 
이곳의 데이터는 수집방법에 따라 차이가 있습니다. 구체적인 정보는 증권앱에서 확인하십시오.

//절차//

//peg 값을 제대로 구해와라//
//이것을 확인하라//
//기타 Trail P/E, For P/E, PEG 값을 구하라
// 10개 종목으로 늘려봐라. 
// 숫자 확인하라
//100개 종목으로 늘려라
//프론트엔드 디자인하라
//디자인 개선하라. 스티브잡스라면,,,, 어떻게 했을까? 
//매일아침 업데이트하라
//참고사항일뿐임을 알려라


